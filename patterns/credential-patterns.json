{
  "name": "Secret Exposure Monitoring Pipeline - Detection Engine",
  "version": "2.0.0",
  "description": "Regex patterns and logic for detecting exposed credentials and secrets in public repositories",
  "patterns": [
    {
      "name": "Private SSH Key",
      "regex": "-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----",
      "severity": "CRITICAL",
      "entropy_threshold": 0,
      "description": "Detection of private RSA, DSA, EC, or OPENSSH keys"
    },
    {
      "name": "Password in Code",
      "regex": "(?i)(password|passwd|pwd).{0,20}[:=]\\s*['\"]([^'\"]{8,})['\"]",
      "severity": "CRITICAL",
      "entropy_threshold": 0,
      "description": "Hardcoded passwords found in code or configuration files"
    },
    {
      "name": "AWS Access Key",
      "regex": "(A3T[A-Z0-9]|AKIA|ASIA)[A-Z0-9]{16}",
      "severity": "HIGH",
      "entropy_threshold": 3.5,
      "description": "Standard AWS Access Key ID with randomness validation"
    },
    {
      "name": "GitHub Token",
      "regex": "gh[pousr]_[A-Za-z0-9_]{30,}",
      "severity": "HIGH",
      "entropy_threshold": 3.2,
      "description": "GitHub Personal, OAuth, User, or Refresh tokens"
    },
    {
      "name": "Stripe Secret Key",
      "regex": "sk_(live|test)_[0-9a-zA-Z]{20,}",
      "severity": "HIGH",
      "entropy_threshold": 3.0,
      "description": "Stripe secret keys (live or test mode)"
    },
    {
      "name": "MongoDB Connection String",
      "regex": "mongodb(?:\\+srv)?:\\/\\/[a-zA-Z0-9_]+:[a-zA-Z0-9_]+@[a-zA-Z0-9.-]+\\.[a-z]{2,}",
      "severity": "HIGH",
      "entropy_threshold": 3.0,
      "description": "MongoDB URIs containing plain-text credentials"
    },
    {
      "name": "Generic Secret",
      "regex": "(?:password|passwd|pass|pwd|secret|auth|api[_-]?key|apikey).{0,20}[:=]\\s*['\"]([^'\"]{8,})['\"]",
      "severity": "MEDIUM",
      "entropy_threshold": 2.8,
      "description": "Common API key and secret variable assignments"
    }
  ],
  "quality_controls": {
    "entropy_algorithm": "Shannon Entropy",
    "false_positive_filters": [
      "example",
      "sample",
      "test",
      "dummy",
      "fake",
      "localhost",
      "127.0.0.1",
      "changeme",
      "todo",
      "your_api_key",
      "replace_me"
    ],
    "ignore_comments": true,
    "comment_syntax": [
      "//",
      "#",
      "/*",
      "*",
      "--"
    ]
  },
  "reporting_logic": {
    "triage_levels": {
      "CRITICAL RISK": "Triggered by CRITICAL severity findings",
      "MEDIUM RISK": "Triggered by HIGH or MEDIUM severity findings",
      "LOW RISK": "Default state for no findings or non-credible secrets"
    },
    "deduplication_key_format": "repository:file:lineNumber:patternType"
  }
}
